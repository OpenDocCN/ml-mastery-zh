# 更多稳定扩散提示技巧

> 原文：[https://machinelearningmastery.com/more-prompting-techniques-for-stable-diffusion/](https://machinelearningmastery.com/more-prompting-techniques-for-stable-diffusion/)

图像扩散模型在其最简单的形式中，从提示生成图像。提示可以是文本提示或图像，只要有适当的编码器将其转换为模型可以用作生成过程条件的张量。文本提示可能是提供条件的最简单方法。它容易提供，但你可能发现很难生成符合预期的图像。在本文中，你将学习：

+   如何构建你的提示

+   有效提示的要素

**用我的书** [《掌握数字艺术与稳定扩散》](https://machinelearningmastery.com/mastering-digital-art-with-stable-diffusion/) **来启动你的项目**。它提供了**自学教程**和**实用代码**。

让我们开始吧。

![](../Images/3ed14307f358de0b4535d3184792854f.png)

更多稳定扩散提示技巧

图片来源：[Simon English](https://unsplash.com/photos/man-standing-on-top-of-mountain-beside-cairn-stones-48nerZQCHgo)。版权所有。

## 概述

本文分为三部分；它们是：

+   使用询问器

+   创建有效的提示

+   实验提示

## 使用询问器

如果你从头开始，可能很难描述你脑海中的图像。这并不容易，因为不是每个人都能有效地用语言表达自己的想法。此外，稳定扩散模型可能也无法理解你的提示。

毋庸置疑，从某些东西开始并加以修改会更容易。你可以复制其他人成功故事中的提示。你也可以提供一张样本图像，让稳定扩散 Web UI 构建提示。这个功能叫做“询问器”。

让我们下载 [一张图片](https://unsplash.com/photos/man-standing-on-top-of-mountain-beside-cairn-stones-48nerZQCHgo) 到硬盘上。前往 Web UI 的“img2img”标签，上传该图像，然后点击带有回形针图标的“询问 CLIP”按钮。

![](../Images/587b1d8ce5743b92ba27764c33f65c77.png)

Web UI 中 img2img 标签下的询问按钮

你应该看到提示生成如下：

> 一名男子站在山顶上，俯视山下的山脉，背着一个背包，肩上有一个背包，Constant Permeke，一张库存照片，敬畏感，后极简主义

这对于启动你的提示工程很有帮助。你可以看到，提示的第一部分描述了图像。然后“Constant Permeke”是一位画家。“后极简主义”是一种艺术运动。与“库存照片”一起，它们的作用是控制风格。术语“敬畏感”控制感觉，暗示这个人背对着镜头，面对自然的奇观。

实际上，在“审问CLIP”旁边，Web界面上还有另一个审问按钮。带有纸板盒图标的是“审问Deepbooru”，基于不同的图像字幕模型。对于同一张图片，您会看到生成的提示如下：

> 1男孩，背包，袋子，蓝天，靴子，建筑物，城市，城市景观，悬崖，云，多云天空，白天，背对，田野，从背后看，草地，山丘，地平线，房子，岛屿，湖泊，风景，男性焦点，山，山脉地平线，海洋，户外，河流，岩石，风景，天空，雪，单独，站立，树木，水，瀑布，波浪

您有一系列关键词而不是句子。您可以编辑用于您的用途的提示，或者将生成的提示作为您的灵感。

询问模型的表现如何？您不应该期望从提示中获得原始图像，但可以接近。在txt2img选项卡上重复提示会给您这个：

![](../Images/f223a88b8284800e9721e8b9adee625a.png)

使用CLIP模型建议的图片生成的图片

不错。但是，如果您使用Deepbooru创建的提示，可能会看到它不那么准确：

![](../Images/1e10488215d7fe93426d131846e1e672.png)

使用Deepbooru询问者建议的提示生成的图片

## 创造有效的提示

CLIP模型适用于照片，而Deepbooru模型适用于插图，动漫和漫画。然而，使用适当的模型与提示非常重要。例如，如果您打算生成动漫风格的图片，则使用像[Counterfeit](https://civitai.com/models/4468/counterfeit-v30)这样的动漫检查点会很有帮助。

让我们重新审视由CLIP模型生成的提示。为什么没有生成原始图片？

一个好的提示应该提到三个S：

+   **主题**：前景中的内容及其设置

+   **场景**：背景内容，包括构图和色彩运用

+   **风格**：图片的抽象描述，包括媒介

确实，这里有第四个S：要**具体**。您应该详细描述您所看到的，但不应该说您所知道的。例如，不要提到背包里面有什么，因为您不能从照片中看到。您不应只提到一个男人，还应该描述他的服装。通常描述看不见和无形的东西（如男人的情绪）是没有帮助的。如果您需要使用同义词词典来帮助您，可以尝试在线提示生成器甚至ChatGPT。

![](../Images/95cbf18919278ca06a901c4a7d2d749f.png)

使用ChatGPT帮助构思用于图像生成的文本提示

让我们试着丰富提示：

+   主题：一个站在山顶上的男人，看着他下面的山脉，背着背包，穿着红色夹克，短裤，背对观众

+   场景：明亮的蓝天，白云，旁边是一堆岩石，令人敬畏的感觉

+   风格：照片逼真，高细节，广角，后极简主义，Constant Permeke

将所有这些结合起来，您可能会发现输出如下所示：

![](../Images/7fc2f8f881173687f12765dad3914b60.png)

由 Stable Diffusion 生成的图片，但未准确遵循提示

还不完美。提示提供了许多细节，但模型并不完全匹配。当然，增加“CFG Scale”参数可以帮助，因为这要求模型更紧密地遵循您的提示。另一种改进方法是查看您的模型生成了什么，并强调模型错过的关键词。您可以使用语法（关键词:权重）调整权重；默认权重为1.0。

上述图片中缺少几个问题。这张图片是一个男人的特写，所以不是广角镜头。这个男人没有穿黑色短裤。让我们强调这两点。通常，将权重从1.0增加到1.1会有所帮助。只有在确认需要时，您才会尝试更重的权重。

![](../Images/dceea6cc3bcfdb82a2aa1dde184d0672.png)

在调整提示中关键词权重后更好的图片

上面的图片显示了提示（black_shorts:1.1）的使用。下划线是故意的，因为它将被解释为空格，但是为了强调这两个词被一起解释。因此，“black”更可能被视为“shorts”的形容词。

有时，您尝试得很努力，但模型并不准确地遵循您的提示。您可以在负面提示上努力，强制表达您不想要的内容。例如，您看到这个人没有完全背对您。您可以将“face”作为负面提示，意思是您不想看到他的脸。

![](../Images/d4ca40c0365efc76ace03331e6646815.png)

使用负面提示有助于生成更好的图片

## 尝试提示

使用稳定扩散创建图片可能需要耐心和大量实验。这是因为不同的模型可能会对相同的提示产生不同的反应，并且图像扩散过程中存在随机性。您可能希望尝试不同的模型，尝试不同的提示，甚至多次重复生成。

在这个试验过程中，一些工具可能会节省您的时间。最简单的方法是一次生成多张图片，每张图片使用不同的随机种子。如果将批次大小设置为大于1，并且将种子保留为$-1$（表示每次生成一个新种子），您可以一键生成多张图片。请注意，这将消耗GPU上更多的内存。如果内存不足，您可以增加批次计数，即运行多次图像生成。速度较慢，但内存消耗较少。

![](../Images/9a2faab7c1dd35d839721e5418a669c1.png)

设置批次大小和批次计数，同时将种子保持为-1，可以一次生成多张图片

一旦从生成的众多候选中找到一个好的候选者，您可以点击图片找到使用的种子。接着，为了进一步完善图片，您应该在修改提示的同时修正种子。每次略微修改提示，以便逐步引导生成，创造您想要的图片。

![](../Images/a6427602647a1f526623a702014b8523.png)

Web UI 将报告用于生成图片的参数，您可以从中找到种子。

但是，您应该如何修改提示？一种方法是尝试关键词的不同组合。在 Web UI 中，您可以使用“提示矩阵”脚本来帮助加速这种实验。您可以将提示设置为由管道字符（|）分隔的不同部分，

> 一个站在山顶上的男人，看着他下面的山，背着背包，穿着红色夹克，（黑色短裤：1.1），（背对视者：1.1），明亮的蓝天，白云，旁边是一堆岩石，敬畏感，（广角：1.1）| 逼真，高细节 | 后极简主义，康斯坦·佩尔米克

然后，在 txt2img 选项卡的底部，在脚本部分选择“提示矩阵”。因为上述提示被设置为积极提示，请在“选择提示”部分选择“积极”。点击“生成”，您将看到生成的多张图片：

![](../Images/1c268d0ef47b7064be900c6493cf77fb.png)

使用提示矩阵脚本进行不同提示的实验

“提示矩阵”枚举了来自您的提示的所有组合，每个部分作为一个单位。请注意，种子和所有其他参数都是固定的；只有提示会变化。这对于公平比较提示效果至关重要。

## 进一步阅读

如果您想更深入地了解这个主题，本节提供了更多资源。

+   为动漫风格图片的伪造模型：[https://civitai.com/models/4468/counterfeit-v30](https://civitai.com/models/4468/counterfeit-v30)

+   逼真视觉模型用于逼真图片：[https://civitai.com/models/4201/realistic-vision-v60-b1](https://civitai.com/models/4201/realistic-vision-v60-b1)

+   [提示生成器](https://promptomania.com/stable-diffusion-prompt-builder/) 由 Promptomania 提供，您可以了解到对提示有用的不同关键词

+   [“注意力和强调”](https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/Features#attentionemphasis) 特性页面上的功能部分，位于 Stable Diffusion Web UI 维基百科

## 概要

在这篇文章中，您学习了一些有助于在 Stable Diffusion 中创建更好图片的技术。具体来说，您学到了：  

+   如何使用询问者从现有图像生成提示

+   有效提示的三个 S：主题、场景和风格

+   如何有效地尝试使用提示
